<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Introduction to ggplot2</title>
    <meta charset="utf-8" />
    <meta name="author" content="Philippe Massicotte" />
    <meta name="date" content="2022-05-19" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/robot-fonts.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/all.css" rel="stylesheet" />
    <link href="libs/font-awesome/css/v4-shims.css" rel="stylesheet" />
    <link href="libs/tile-view/tile-view.css" rel="stylesheet" />
    <script src="libs/tile-view/tile-view.js"></script>
    <link href="libs/animate.css/animate.xaringan.css" rel="stylesheet" />
    <link href="libs/tachyons/tachyons.min.css" rel="stylesheet" />
    <script src="libs/js-cookie/js.cookie.js"></script>
    <script src="libs/peerjs/peerjs.min.js"></script>
    <script src="libs/tiny.toast/toast.min.js"></script>
    <link href="libs/xaringanExtra-broadcast/broadcast.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-broadcast/broadcast.js"></script>
    <script src="libs/clipboard/clipboard.min.js"></script>
    <link href="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.css" rel="stylesheet" />
    <script src="libs/xaringanExtra-clipboard/xaringanExtra-clipboard.js"></script>
    <script>window.xaringanExtraClipboard(null, {"button":"<i>Copy<\/i>","success":"<i class=\"fa fa-check\" style=\"color: #90BE6D\"><\/i>","error":"<i class=\"fa fa-times-circle\" style=\"color: #F94144\"><\/i>"})</script>
    <script src="libs/kePrint/kePrint.js"></script>
    <link href="libs/lightable/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="styles.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">


&lt;!-- https://evamaerey.github.io/flipbooks/flipbook_recipes#49 --&gt;









class: title-slide, center, bottom

# Introduction to ggplot2

&lt;figure&gt;
  &lt;img src="img/sn_logo.png" alt="Logo of Sentinel North. Shows a stars in the middle." width = "450"/&gt;
&lt;/figure&gt;

May 19, 2022 (updated: 2022-05-12)

## Philippe Massicotte

---

name: hello
class: middle, center, inverse

&lt;img src="img/myname.png" width="300px"/&gt;

&lt;b&gt;Research assistant at Takuvik (Laval University)&lt;/b&gt;&lt;br&gt;

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="img/takuvik.svg" alt="Logo of Takuvik." width = "300"/&gt;
&lt;/figure&gt;
&lt;/center&gt;

&lt;small&gt;*Remote sensing, modelling, data science, data visualization*&lt;/small&gt;&lt;br&gt;

[<svg aria-hidden="true" role="img" viewBox="0 0 496 512" style="height:1em;width:0.97em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg> @pmassicotte](https://github.com/PMassicotte)    
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg> @philmassicotte](https://twitter.com/apreshill)   
[<svg aria-hidden="true" role="img" viewBox="0 0 512 512" style="height:1em;width:1em;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:currentColor;overflow:visible;position:relative;"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"/></svg> www.pmassicotte.com](https://www.pmassicotte.com)

---

# Outline

- Brief introduction to data visualization
  - General advice to make graphics

- `ggplot2` basic plots
    - Histograms and bar plots
    - Points and lines plots
    - Boxplots

- `ggplot2` aesthetics and appearance
    - Color, size
    - Axes and titles
    - Faceting (small multiples)
    - Overview of the `theme()` function

---

# Not covered today

--

- Data importation, manipulation and transformation
  - `data.table` - https://rdatatable.gitlab.io/data.table/

  - `readr` - https://r4ds.had.co.nz/data-import.html

  - `readxl` - https://readxl.tidyverse.org/

  - `dplyr`, `tidyr` - https://r4ds.had.co.nz/tidy-data.html

--

- Data visualization theory
  - [Fundamentals of Data Visualization](https://clauswilke.com/dataviz/)
  - [What to consider when choosing colors for data visualization](https://blog.datawrapper.de/colors/)
  - [What to consider when visualizing data for colorblind readers](https://blog.datawrapper.de/colorblindness-part2/)
  - [Choosing Color Palettes for Data Visualization That Are Accessible for Most Audiences](https://www.youtube.com/watch?v=PstHyodalWg)

---

# Data visualization

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://blog.rstudio.com/2019/11/18/artist-in-residence/horst-eco-r4ds.png" width="800"&gt;
&lt;figcaption&gt;Artwork by &lt;a href="https://twitter.com/allison_horst?s=20"&gt;@allison_horst&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;

---

# Data visualization

--

- An important aspect of data sciences:
    - **Communicate information clearly and efficiently to the community.**

--

- Powerful tool to discover patterns in the data:
    - It makes complex data more accessible: **reveal the data**.

--

- Bad graphics can be a reason for paper rejection:
    - **Readers should rapidly understand the message you are trying to convey.**

--

- A picture is worth a thousand words:
    - **Always, always, always plot your data!**
    - When possible, replace tables with figures.

---

# Datasaurus Dozen

&lt;img src="index_files/figure-html/unnamed-chunk-1-1.svg" style="display: block; margin: auto;" /&gt;

--

**These 13 datasets have the same statistical properties (*mean*, *variance*, *correlation*).** However, they look quite different!

---

# Visualization to convey your message

It can be difficult to grasp the information contained in a table.

.pull-left[
&lt;table class="table" style="font-size: 18px; margin-left: auto; margin-right: auto;"&gt;
&lt;caption style="font-size: initial !important;"&gt;Sea ice extent in the Arctic between 1978 and 2021.&lt;/caption&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt; date &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; extent &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-10-26 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.231 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-10-28 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.420 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-10-30 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.557 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-01 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.670 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-03 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.777 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-05 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 10.968 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-07 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 11.080 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-09 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 11.189 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-11 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 11.314 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;width: 3in; "&gt; 1978-11-13 &lt;/td&gt;
   &lt;td style="text-align:right;width: 3in; "&gt; 11.460 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
]

.pull-right[
&lt;center&gt;
    &lt;img src="img/arctic_seaice_extent.png" alt="Map showing the Arctic sea ice extent in October 2021." height="400"/&gt;
&lt;/center&gt;
]

&lt;small&gt;
[Data from NSIDC](ftp://sidads.colorado.edu/DATASETS/NOAA/G02135/north/daily/data/N_seaice_extent_daily_v3.0.csv)
&lt;/small&gt;

---

# Visualization to convey your message

Graphics, on the other hand, can help to convey your message.

&lt;img src="index_files/figure-html/unnamed-chunk-3-1.svg" width="70%" style="display: block; margin: auto;" /&gt;

---

# Visualization to convey your message

The same data but presented differently.

&lt;img src="index_files/figure-html/unnamed-chunk-4-1.svg" style="display: block; margin: auto;" /&gt;

Interesting reading: [Arctic Sea Ice Extent Second Highest in 18 Years at the end of 2021](https://www.severe-weather.eu/global-weather/arctic-sea-ice-second-highest-18-years-end-2021-rrc/)

---

# Visualization to convey your message

The same data but presented differently.

&lt;img src="index_files/figure-html/sie-rect-plot-1.svg" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# The anatomy of misleading graphs

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/isaac-smith-AT77Q0Njnt0-unsplash.jpg" alt="A handmade graph on a piece of paper." width = "450"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@isaacmsmith?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Isaac Smith&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/graph?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

---

# The anatomy of misleading graphs

&gt; In statistics, a misleading graph, also known as a distorted graph, is a graph that misrepresents data, constituting a misuse of statistics and with the result that an incorrect conclusion may be derived from it (Wikipedia).

--

- Defining what makes a good graph can be subjective to a certain extent.

--

- Nevertheless, there are a couple of elements that characterize misleading/bad graphs:

  - Improper axis scaling

  - Truncated graphs

  - Unnecessary use of 3D
  
  - Bad choice of colours

---

## The good, the bad and the ugly of data viz

There are many resources online that provide advice for making good graphs and avoiding pitfalls:

- [Data is ugly](https://www.reddit.com/r/dataisugly/)

- [Data Visualization Examples: Good, Bad and Misleading](https://www.syntaxtechs.com/blog/data-visualization-examples)

- [10 good and bad examples of data visualization](https://www.polymersearch.com/blog/10-good-and-bad-examples-of-data-visualization)

- [15 Misleading Data Visualization Examples](https://rigorousthemes.com/blog/misleading-data-visualization-examples/)

---

## Did Apple presented a misleading graph?

Back in 2013, Tim Cook presented this chart showing cumulative iPhone sales.

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="img/iphone-sales1.png" width="600"&gt;
&lt;/figure&gt;
&lt;figcaption&gt;Credit: &lt;a href="https://qz.com/122921/the-chart-tim-cook-doesnt-want-you-to-see/"&gt;https://qz.com/&lt;/a&gt; 
&lt;/figcaption&gt; 
&lt;/center&gt;

---

## Did Apple presented a misleading graph?

&gt; Using data from Apple’s own quarterly reports filed with the Securities and Exchange Commission, I made a better chart.

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="img/iphone-sales2.png" width="600"&gt;
&lt;/figure&gt;
&lt;figcaption&gt;Credit: &lt;a href="https://qz.com/122921/the-chart-tim-cook-doesnt-want-you-to-see/"&gt;https://qz.com/&lt;/a&gt; 
&lt;/figcaption&gt; 
&lt;/center&gt;

---

# Exaggerating variations

- It is easy to exaggerate variation in the data by manipulating the range of an axis.

- In this example, changing the maximum of the **y-axis** in panel **B** suggests that the increase is less steep than in **A**.

&lt;img src="index_files/figure-html/unnamed-chunk-5-1.svg" style="display: block; margin: auto;" /&gt;

---

# Aspect ratio

These three graphs show the same data with different aspect ratios which considerably influences the visual perception.

&lt;img src="index_files/figure-html/unnamed-chunk-6-1.svg" style="display: block; margin: auto;" /&gt;

---

# Aspect ratio

.pull-left[
- Choosing the appropriate aspect ratio for the data can help to distinguish certain features. 

- To illustrate it, we will use **yearly sunspot numbers from 1700-1988** (data: [WDC-SILSO, Royal Observatory of Belgium](http://www.sidc.be/silso/datafiles)).

- Examples and advice stole from https://graphworkflow.com/enhancement/aspect/.
]

.pull-right[
&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/nasa-JHyiw_dpALk-unsplash.jpg" alt="Close-up image of the sun with visible sunspots." width = "350"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@nasa?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;NASA&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/sun?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
  
    &lt;/figcaption&gt; 
&lt;/center&gt;
]

---

# Aspect ratio

On the following graph, we can observe what seems to be a solar cycle of sunspot activity repeated every 11-13 years.

&lt;img src="index_files/figure-html/sunspot1-1.svg" style="display: block; margin: auto;" /&gt;

---

# Aspect ratio

Using a very wide aspect ratio reveals an interesting pattern.

&lt;img src="index_files/figure-html/sunspot2-1.png" style="display: block; margin: auto;" /&gt;

--

Sunspot cycles &lt;b&gt;&lt;font color="#E15554"&gt;increase more rapidly&lt;/font&gt;&lt;/b&gt; &lt;b&gt;&lt;font color="#4D9DE0"&gt;than they decrease&lt;/font&gt;&lt;/b&gt; when the number of sunspots is higher.

&lt;img src="index_files/figure-html/sunspot3-1.png" style="display: block; margin: auto;" /&gt;

--

Although we can see the different types of cycles better, the graph looks too stretched.

---

# Aspect ratio

**A better option consists to split the data into subsets.** Here, each panel presents the data for a specific century.

&lt;img src="index_files/figure-html/sunspot4-1.png" width="50%" style="display: block; margin: auto;" /&gt;

---

# Truncated graphs

- Truncated graphs (**especially barplot**) can be very misleading because the *y-axis* does not start at 0.

- The graph in **panel A** suggests that Olivier's salary  **is 10 times more** than Benjamin's.

&lt;img src="index_files/figure-html/unnamed-chunk-7-1.svg" style="display: block; margin: auto;" /&gt;

---

# Unnecessary use of 3D

- 3D graphics are very rarely useful:
  - First, they break the data-to-ink ratio rule (*more about that in a moment*).
  - Secondly, they can distort the reality.

- On the left graph, the visual perspective suggests that **Item C** is as large as **Item A**, whereas in fact, **Item A** is two times bigger than **Item C**.

.pull-left[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://upload.wikimedia.org/wikipedia/commons/8/88/Misleading_Pie_Chart.png" width="300"&gt;
&lt;/figure&gt;
&lt;figcaption&gt;Credit: Wikipedia&lt;/figcaption&gt;
&lt;/center&gt;
]

.pull-right[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://upload.wikimedia.org/wikipedia/commons/8/87/Sample_Pie_Chart.png" width="300"&gt;
&lt;/figure&gt;
&lt;figcaption&gt;Credit: Wikipedia&lt;/figcaption&gt;
&lt;/center&gt;
]

---

# Improper axe scale labeling

- There is nothing wrong to use a logarithm scaling (I do it very often), but be careful to annotate the axis adequately, so the viewer is aware of it.
  - **If not clearly specified, the user may assume that the data is presented on a linear scale.**

- On a `log10` scale, a difference of 1 unit, represents 1 order magnitude.

&lt;img src="index_files/figure-html/unnamed-chunk-8-1.svg" width="70%" style="display: block; margin: auto;" /&gt;

---

# Data-ink ratio

The data-ink ratio is the proportion of ink that is used to present actual data compared to the total amount of ink used in the entire display.

&lt;br&gt;

$$
\verb|data-ink ratio| = \frac{\verb|Data-ink|}{\verb|Total ink used to print the graphic|}
$$

&lt;br&gt;

The data-to-ink ratio should be kept as high as possible.

---

# Data-ink ratio

Here, both graphs contain the same data. However, the grey background in **panel A** is unnecessary.

&lt;img src="index_files/figure-html/unnamed-chunk-9-1.svg" style="display: block; margin: auto;" /&gt;

---
class: partial

# Sometimes rules are made to be broken

&lt;img src="index_files/figure-html/unnamed-chunk-10-1.svg" style="display: block; margin: auto;" /&gt;

---

# Further resources

- There are plenty of resources online about **the do's and don'ts** of data visualization. 

- Recommended reading: [Fundamentals of Data Visualization](https://clauswilke.com/dataviz/index.html) (freely available online).

&lt;center&gt;
&lt;img src="img/fundamentals_data_visualization_cover.png" width="300"&gt;
&lt;/center&gt;

---

class: inverse, center, middle

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/ggplot2_masterpiece.png?raw=true" width="700"&gt;
&lt;figcaption&gt;Artwork by &lt;a href="https://twitter.com/allison_horst?s=20"&gt;@allison_horst&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;

---

# ggplot2

`ggplot2` is a system for declaratively creating graphics, based on [The Grammar of Graphics](https://amzn.to/2ef1eWp).

&gt; Presents a unique foundation for producing almost every quantitative graphic found in scientific journals, newspapers, statistical packages, and data visualization systems.

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="img/grammar_of_graphics.png" width="600"&gt;
&lt;figcaption&gt;Source: &lt;a href="https://bit.ly/3JwHavs"&gt;Thomas de Beus&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;

---

# ggplot2

`ggplot2` is not part of base R, so it needs to be installed.

.left-column[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/tidyverse/ggplot2/master/man/figures/logo.png" width="300"&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

.right-column[


```r
install.packages("ggplot2")
```

After the installation, you will have to load it.


```r
library(ggplot2)
```
]

---

# ggplot2

.column-left[
- `ggplot2` is a very powerful tool. 

- The learning curve can be difficult, but **the time investment will eventually pay off.**
]

.column-right[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/r_first_then.png?raw=true" height="500"&gt;
    &lt;figcaption&gt;
    Artwork by &lt;a href="https://twitter.com/allison_horst?s=20"&gt;@allison_horst&lt;/a&gt;
    &lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

---

# TidyTuesday

TidyTuesday is a weekly challenge where people use (mostly) `ggplot2` to explore a new dataset.

&gt; A weekly data project aimed at the R ecosystem. As this project was borne out of the R4DS Online Learning Community and the R for Data Science textbook, an emphasis was placed on understanding how to summarize and arrange data to make meaningful charts with `ggplot2`, `tidyr`, `dplyr`, and other tools in the `tidyverse` ecosystem.

&lt;center&gt;
    &lt;img src="https://github.com/rfordatascience/tidytuesday/blob/master/static/tt_logo.png?raw=true" alt="drawing" width="450"/&gt;
    &lt;figcaption&gt;
    &lt;a href="https://twitter.com/search?q=%23TidyTuesday&amp;src=hashtag_click"&gt;#TidyTuesday on &lt;i class="fab fa-twitter"&gt;&lt;/i&gt;&lt;/a&gt;
    &lt;/figcaption&gt;
&lt;/center&gt;

---

# TidyTuesday

As already said, `ggplot2` can be intimidating at first. However, with some practice, you will be able to make stunning graphics.

&lt;center&gt;
&lt;div class="row"&gt;
    &lt;div class="column"&gt;
        &lt;img src="https://github.com/loreabad6/TidyTuesday/blob/master/plot/2022_week_03.png?raw=true"
            alt="Who makes the best chocolate with Ecuadorian beans?" style="width:120%"&gt;
        &lt;figcaption&gt;
            Graphic by &lt;a href=https://twitter.com/loreabad6&gt;@loreabad6&lt;/a&gt;
        &lt;/figcaption&gt;
    &lt;/div&gt;
    &lt;div class="column"&gt;
        &lt;img src="https://github.com/jkaupp/tidytuesdays/blob/437b47ad14bd3d6d66dca41e0a4a84c9d96716fb/2020/week44/tw44_plot.png?raw=true"
            alt="Wind power generation in the Maritimes" style="width:80%"&gt;
        &lt;figcaption&gt;
            Graphic by &lt;a href=https://twitter.com/jakekaupp"&gt;@jakekaupp&lt;/a&gt;
        &lt;/figcaption&gt;
    &lt;/div&gt;
    &lt;div class="column"&gt;
        &lt;img src="https://github.com/gkaramanis/aRtist/blob/main/genuary/2021/2021-3/2021-3.png?raw=true" alt="Person's face ploted using ggplot2"
            style="width:80%"&gt;
        &lt;figcaption&gt;
            Graphic by &lt;a href=https://twitter.com/geokaramanis?lang=en"&gt;@geokaramanis&lt;/a&gt;
        &lt;/figcaption&gt;
    &lt;/div&gt;
&lt;/div&gt;
&lt;/center&gt;

**Most people participating in the TidyTuesday challenges share their code on Github. It is a great way to learn more advanced techniques!**

---

class: inverse, center, middle

# Let's start with ggplot2!

---

# Different types of visualizations

There are many types of visualization to choose from to present data. The decision depends on the data itself and how you want to present it to your audience.

&lt;center&gt;
    &lt;img src="img/chart_types.png" alt="xxx" height="375"/&gt;
    &lt;figcaption&gt;
    &lt;a href="https://www.kdnuggets.com/2019/03/how-choose-right-chart-type.html"&gt;How to Choose the Right Chart Type&lt;/a&gt;
    &lt;/figcaption&gt;
&lt;/center&gt;

---

# The Palmer Penguins: the new iris

Data were collected and made available by [Dr. Kristen Gorman](https://www.uaf.edu/cfos/people/faculty/detail/kristen-gorman.php) and the [Palmer Station, Antarctica LTER](https://pal.lternet.edu/), a member of the [Long Term Ecological Research Network](https://lternet.edu/). 

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/man/figures/lter_penguins.png" width="600"&gt;
&lt;/figure&gt;
&lt;figcaption&gt;
    Artwork by &lt;a href="https://twitter.com/allison_horst?s=20"&gt;@allison_horst&lt;/a&gt;
&lt;/figcaption&gt;
&lt;/center&gt;

---

# The Palmer Penguins

The dataset contain data for **344 penguins** from **3 different species** (&lt;pu&gt;&lt;b&gt;Chinstrap&lt;/b&gt;&lt;/pu&gt;, &lt;cy&gt;&lt;b&gt;Gentoo&lt;/b&gt;&lt;/cy&gt; and &lt;or&gt;&lt;b&gt;Adélie&lt;/b&gt;&lt;/or&gt;) collected from **3 islands** in the Palmer Archipelago, Antarctica.

&lt;small&gt;
.pull-left[

- `species`: penguin species (*Adélie*, *Chinstrap* and *Gentoo*)

- `island`: island in Palmer Archipelago, Antarctica (*Biscoe*, *Dream* and *Torgersen*)

- `bill_length_mm`: bill length (millimeters)

- `bill_depth_mm`: bill depth (millimeters)

- `flipper_length_mm`: flipper length (millimeters)

- `body_mass_g`: body mass (grams)

- `sex`: penguin sex (*female*, *male*)

- `year`: year of the study (2007, 2008 and 2009)

]
&lt;/small&gt;

.pull-right[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/man/figures/culmen_depth.png" width="700"&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

---

# Installing the data

.left-column[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://raw.githubusercontent.com/allisonhorst/palmerpenguins/master/man/figures/logo.png" width="300"&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

.right-column[
You can install the data as follow:


```r
# install.packages("remotes")
remotes::install_github("allisonhorst/palmerpenguins")
```
]

---

# The palmer penguins data

Let's load the data into R.

&lt;small&gt;

```r
library(palmerpenguins)
penguins
```

```
## # A tibble: 344 × 8
##    species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
##    &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
##  1 Adelie  Torgersen           39.1          18.7               181        3750
##  2 Adelie  Torgersen           39.5          17.4               186        3800
##  3 Adelie  Torgersen           40.3          18                 195        3250
##  4 Adelie  Torgersen           NA            NA                  NA          NA
##  5 Adelie  Torgersen           36.7          19.3               193        3450
##  6 Adelie  Torgersen           39.3          20.6               190        3650
##  7 Adelie  Torgersen           38.9          17.8               181        3625
##  8 Adelie  Torgersen           39.2          19.6               195        4675
##  9 Adelie  Torgersen           34.1          18.1               193        3475
## 10 Adelie  Torgersen           42            20.2               190        4250
## # … with 334 more rows, and 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;
```
&lt;/small&gt;

**Note that the `ggplot2` works best when using data frames.**

---

# Understanding the ggplot2 syntax

A `ggplot2` plot is built layer by layer by using the `+` operator. 

&lt;center&gt;
    &lt;img src="img/ggplot2_structure.png" alt="drawing" width="1000"/&gt;
&lt;/center&gt;
&lt;figcaption&gt;
    The basic structure of a ggplot2 plot.
&lt;/figcaption&gt;
        
---

# The geoms 

`geoms` is the abbreviation for *geometric objects* which are used to specify which type of graphic you want to produce (**boxplot**, **barplot**, **scatterplot**, **histogram**, ...). All `ggplot2` geoms start with the `geom_` prefix.

&lt;small&gt;

```
##  [1] "geom_abline"            "geom_area"              "geom_bar"              
##  [4] "geom_bin_2d"            "geom_bin2d"             "geom_blank"            
##  [7] "geom_boxplot"           "geom_col"               "geom_contour"          
## [10] "geom_contour_filled"    "geom_count"             "geom_crossbar"         
## [13] "geom_curve"             "geom_density"           "geom_density_2d"       
## [16] "geom_density_2d_filled" "geom_density2d"         "geom_density2d_filled" 
## [19] "geom_dotplot"           "geom_errorbar"          "geom_errorbarh"        
## [22] "geom_freqpoly"          "geom_function"          "geom_hex"              
## [25] "geom_histogram"         "geom_hline"             "geom_jitter"           
## [28] "geom_label"             "geom_line"              "geom_linerange"        
## [31] "geom_map"               "geom_path"              "geom_point"            
## [34] "geom_pointrange"        "geom_polygon"           "geom_qq"               
## [37] "geom_qq_line"           "geom_quantile"          "geom_raster"           
## [40] "geom_rect"              "geom_ribbon"            "geom_rug"              
## [43] "geom_segment"           "geom_sf"                "geom_sf_label"         
## [46] "geom_sf_text"           "geom_smooth"            "geom_spoke"            
## [49] "geom_step"              "geom_text"              "geom_tile"             
## [52] "geom_violin"            "geom_vline"
```
&lt;/small&gt;

---

class: inverse, center, middle

# One variable graphics

---

# One variable graphics

In this section, we are going to see the two main types of one variable graphics:

| **Graphic type** | **Geom**           | **Description**                          |
| ---------------- | ------------------ | ---------------------------------------- |
| Histogram        | `geom_histogram()` | Produces histograms for continuous data. |
| Barplot          | `geom_bar()`       | Produces histograms for discrete data.   |




---

count: false
 
# Histogram
.panel1-histogram1-auto[

```r
*ggplot(
* data = penguins,
* mapping = aes(x = body_mass_g)
*) 
```
]
 
.panel2-histogram1-auto[
&lt;img src="index_files/figure-html/histogram1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Histogram
.panel1-histogram1-auto[

```r
ggplot(
  data = penguins,
  mapping = aes(x = body_mass_g)
) +
* geom_histogram()
```
]
 
.panel2-histogram1-auto[
&lt;img src="index_files/figure-html/histogram1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-histogram1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-histogram1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-histogram1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
# Barplot
.panel1-barplot1-auto[

```r
*ggplot(
* data = penguins,
* mapping = aes(x = island)
*) 
```
]
 
.panel2-barplot1-auto[
&lt;img src="index_files/figure-html/barplot1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Barplot
.panel1-barplot1-auto[

```r
ggplot(
  data = penguins,
  mapping = aes(x = island)
) +
* geom_bar()
```
]
 
.panel2-barplot1-auto[
&lt;img src="index_files/figure-html/barplot1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-barplot1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-barplot1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-barplot1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

class: inverse, center, middle

# Two variables graphics

---

# Two variables graphics

There are several types of charts with two variables. Here are the most used.

| **Graphic type** | **Geom**         | **Description**                                               |
| ---------------- | ---------------- | ------------------------------------------------------------- |
| Barplot          | `geom_col()`     | Produces bars with heights that represent values in the data. |
| Scatter plot     | `geom_point()`   | Produces scatter plot between `x` and `y`.                    |
| Line plot        | `geom_line()`    | Produces line plot between `x` and `y`.                       |
| Boxplot          | `geom_boxplot()` | Boxplot between `x` and `y`.                                  |

---

# Barplot

We used `geom_bar()` to visualize the number/count of cases for each value of `x`. If we want to represent values in the data (`y`), we can use `geom_col()`. For this example, I will use the `starwars` data that is included in the `dplyr` package. **This graph shows the top 20 tallest characters (in cm).**



.pull-left[

```r
ggplot(
  data = sw,
  mapping = aes(
*   x = name,
*   y = height
  )
) +
  geom_col()
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-17-1.svg" style="display: block; margin: auto;" /&gt;
]

--

**What could be done to improve this graph?**

---

# Barplot

In the previous graph, it was difficult to read the names on the `x-axis`. **A better way to present the data is by swapping the `x` and `y` axes.**

--

.pull-left[

```r
ggplot(
  data = sw,
  mapping = aes(
*   x = height,
*   y = name
  )
) +
  geom_col()
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-18-1.svg" style="display: block; margin: auto;" /&gt;
]

--

**Can we improve the graph furthermore?**

---

# Ordering things

We have made some improvements in the previous graph by swapping the axes. However, **it would be even better if the characters were sorted by their height** to make the plot easier to understand. 

--

One way to do it is with `forcats::fct_reorder()`. Note that the `forcats` library is not part of base R and must be installed separately.

--

.pull-left[
&lt;small&gt;

```r
ggplot(
  data = sw,
  mapping = aes(
    x = height,
*   y = forcats::fct_reorder(name, height)
  )
) +
  geom_col()
```
&lt;/small&gt;
]

--

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-19-1.svg" style="display: block; margin: auto;" /&gt;
]

---



count: false
 
# Scatter plot
.panel1-scatterplot1-auto[

```r
*ggplot(
* penguins,
* aes(
*   x = bill_length_mm,
*   y = body_mass_g
* )
*) 
```
]
 
.panel2-scatterplot1-auto[
&lt;img src="index_files/figure-html/scatterplot1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Scatter plot
.panel1-scatterplot1-auto[

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
* geom_point()
```
]
 
.panel2-scatterplot1-auto[
&lt;img src="index_files/figure-html/scatterplot1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-scatterplot1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-scatterplot1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-scatterplot1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# Adding a regression line

Use `geom_smooth(method = "lm")` to add a linear regression line to your data.

.pull-left[
&lt;small&gt;

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point()+
* geom_smooth(method = "lm")
```
&lt;/small&gt;
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-20-1.svg" style="display: block; margin: auto;" /&gt;
]

---

# Adding a smoothing line

If the argument `method` is not specified, a `loess` or a `gam` model will be used (depending on the number of points to be fitted).

.pull-left[
&lt;small&gt;

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point()+
* geom_smooth()
```
&lt;/small&gt;
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-21-1.svg" style="display: block; margin: auto;" /&gt;
]

---



count: false
 
# Line plot
.panel1-lineplot1-auto[

```r
*ggplot(
* penguins,
* aes(
*   x = bill_length_mm,
*   y = body_mass_g
* )
*) 
```
]
 
.panel2-lineplot1-auto[
&lt;img src="index_files/figure-html/lineplot1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Line plot
.panel1-lineplot1-auto[

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
* geom_line()
```
]
 
.panel2-lineplot1-auto[
&lt;img src="index_files/figure-html/lineplot1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-lineplot1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-lineplot1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-lineplot1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# Boxplot

&gt; In descriptive statistics, a box plot or boxplot is a convenient way of graphically depicting groups of numerical data through their quartiles (Wikipedia).

To make a boxplot, we need to have a **discrete/categorical** variable on `x` and a **continuous** variable on `y`.

---



count: false
 
# Boxplot
.panel1-boxplot1-auto[

```r
*ggplot(
* data = penguins,
* mapping = aes(
*   x = island,
*   y = body_mass_g
* )
*) 
```
]
 
.panel2-boxplot1-auto[
&lt;img src="index_files/figure-html/boxplot1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Boxplot
.panel1-boxplot1-auto[

```r
ggplot(
  data = penguins,
  mapping = aes(
    x = island,
    y = body_mass_g
  )
) +
* geom_boxplot()
```
]
 
.panel2-boxplot1-auto[
&lt;img src="index_files/figure-html/boxplot1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-boxplot1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-boxplot1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-boxplot1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# Boxplot

We can reorder the `island` variable based on the `body_mass_g` variable to make the graphic more appealing with `forcats::fct_reorder()`.

--

.pull-left[
&lt;small&gt;

```r
ggplot(
  data = penguins,
  mapping = aes(
*   x = forcats::fct_reorder(
*     island,
*     body_mass_g,
*     na.rm = TRUE
*   ),
    y = body_mass_g 
  )
) +
  geom_boxplot()
```
&lt;/small&gt;
]

--

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-22-1.svg" style="display: block; margin: auto;" /&gt;
]

Note the use of `na.rm = TRUE` in the `fct_reorder()` function.

---

class: inverse, center, middle

# Geom aesthetics

---

# Geom aesthetics

Aesthetics such as *colour*, *shape*, *size* of the displayed geoms can be controlled inside the `geom_()` functions. For example, we can change the `color` and the `size` of the point in the `geom_point()` function.


```r
# All points will be red with a size of 5
geom_point(color = "red", size = 5) 
```

&lt;img src="index_files/figure-html/unnamed-chunk-24-1.svg" style="display: block; margin: auto;" /&gt;

---

# Working with colours

If we want to set a colour **based on a variable**, we have to use the aesthetic: `aes(colour = variable)`.


```r
ggplot(penguins, aes(x = bill_length_mm, y = body_mass_g)) +
* geom_point(aes(color = species))
```

&lt;img src="index_files/figure-html/unnamed-chunk-25-1.svg" style="display: block; margin: auto;" /&gt;

---



count: false
 
# Setting colors manually 
 We can also create our own palette of colors using *scale_color_manual()*.
.panel1-manual_colors1-auto[

```r
*ggplot(
* penguins,
* aes(
*   x = bill_length_mm,
*   y = body_mass_g
* )
*) 
```
]
 
.panel2-manual_colors1-auto[
&lt;img src="index_files/figure-html/manual_colors1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Setting colors manually 
 We can also create our own palette of colors using *scale_color_manual()*.
.panel1-manual_colors1-auto[

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
* geom_point(aes(color = species))
```
]
 
.panel2-manual_colors1-auto[
&lt;img src="index_files/figure-html/manual_colors1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Setting colors manually 
 We can also create our own palette of colors using *scale_color_manual()*.
.panel1-manual_colors1-auto[

```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point(aes(color = species)) +
* scale_color_manual(
*   breaks = c(
*     "Adelie",
*     "Chinstrap",
*     "Gentoo"
*   ),
*   values = c(
*     "darkorange",
*     "purple",
*     "#008b8b"
*   )
* )
```
]
 
.panel2-manual_colors1-auto[
&lt;img src="index_files/figure-html/manual_colors1_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-manual_colors1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-manual_colors1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-manual_colors1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# Setting color manually

This can also be done in one step **using a named vector** of colors.

`c("Adelie" = "darkorange", "Chinstrap" = "purple", "Gentoo" = "#008b8b")`


```r
ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point(aes(color = species)) +
  scale_color_manual(values = c(
    "Adelie" = "darkorange",
    "Chinstrap" = "purple",
    "Gentoo" = "#008b8b"
  ))
```

---

background-image: url(https://github.com/EmilHvitfeldt/paletteer/blob/master/man/figures/logo.png?raw=true)
background-size: 90px
background-position: 90% 8%

# Color palettes for ggplot2

Many different R packages provide colour palettes.

`paletteer` is a comprehensive collection of colour palettes in R created by [@Emil_Hvitfeldt](https://twitter.com/Emil_Hvitfeldt). I have made a [paletteer gallery](https://github.com/PMassicotte/paletteer_gallery) to help me navigate all the palettes.

.pull-left[

&lt;small&gt;

```r
*library(paletteer)

ggplot(
  data = sw,
  mapping = aes(
    x = height,
    y = forcats::fct_reorder(name, height),
*   fill = height
  )
) +
  geom_col() +
* scale_fill_paletteer_c("ggthemes::Red-Gold")
```
&lt;/small&gt;
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-27-1.svg" style="display: block; margin: auto;" /&gt;
]

---

# Types of colour scales

**Attention to the type of colour scale that is mapped to your data.**

--

- Use `scale_color_*()` of `scale_colour_*()` for the **color** of the geom.

--

- Use `scale_fill_*()` for the **fill color** of the geom.

--

.pull-left[

&lt;br&gt;

&lt;small&gt;

```r
ggplot(
  data = sw,
  mapping = aes(
    x = height,
    y = forcats::fct_reorder(name, height),
*   fill = height,
*   color = eye_color
  )
) +
  geom_col(size = 1)
```
&lt;/small&gt;
]

.pull-right[

&lt;img src="index_files/figure-html/unnamed-chunk-28-1.svg" height="80%" style="display: block; margin: auto;" /&gt;
]

---

# Continuous vs discrete mapping

**Attention to the type of data you are mapping to a colour or shape scale.**

If the mapped variable is **continuous**, the generated guide on the legend will be also **continuous**.


```r
ggplot(penguins, aes(x = bill_length_mm, y = body_mass_g)) +
* geom_point(aes(color = year))
```

&lt;img src="index_files/figure-html/continuous-mapping-1.svg" style="display: block; margin: auto;" /&gt;

---

# Continuous vs discrete mapping

**Attention to the type of data you are mapping to a colour or shape scale.**

If the mapped variable is **discrete**, the generated guide on the legend will be also **discrete**. You can convert a continuous variable into a factor with the `factor()` function.



```r
ggplot(penguins, aes(x = bill_length_mm, y = body_mass_g)) +
* geom_point(aes(color = factor(year)))
```

&lt;img src="index_files/figure-html/discrete-mapping-1.svg" style="display: block; margin: auto;" /&gt;

---

# Working with size

As we did for the colours, the size of the geom (ex.: points) can be based on a particular variable.


```r
ggplot(penguins, aes(x = bill_length_mm, y = body_mass_g)) +
* geom_point(aes(size = body_mass_g))
```

&lt;img src="index_files/figure-html/unnamed-chunk-29-1.svg" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# Color blindness

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/ronald-cuyan-AJgFLjnmSs4-unsplash.jpg" alt="Someone with a basket on his shoulder. The basket contains what looks like plants of various colors." width = "550"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@ronaldcuyan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Ronald Cuyan&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/color-blind?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

---

# Colours for colourblind readers

&gt; Colour (color) blindness (colour vision deficiency, or CVD) affects approximately 1 in 12 men (8%) and 1 in 200 women. Source: https://www.colourblindawareness.org/colour-blindness/

--

.pull-left[

&lt;small&gt;For non colorblind viewers, this plot looks perfectly fine.&lt;/small&gt;
&lt;br&gt;

&lt;img src="index_files/figure-html/unnamed-chunk-30-1.svg" width="90%" style="display: block; margin: auto;" /&gt;
]

--

.pull-right[

&lt;small&gt;However, for some colorblind viewers, the &lt;orange&gt;&lt;b&gt;orange&lt;/b&gt;&lt;/orange&gt; and the &lt;green&gt;&lt;b&gt;green&lt;/b&gt;&lt;/green&gt; colors are hardly distinguishable.&lt;/small&gt;

&lt;img src="index_files/figure-html/unnamed-chunk-31-1.svg" style="display: block; margin: auto;" /&gt;
]

---

# Colours for colourblind readers

Whenever possible, try to carefully choose a colorblind-friendly colours scheme.

Here is a scatterplot using `ggplot2` default colour palette.

.pull-left[


```r
p &lt;- ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point(aes(color = species))
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-33-1.svg" style="display: block; margin: auto;" /&gt;
]

---

# Colours for colourblind readers

- Color deficiency simulations can be made using the `colorblindr`
package.

- `ggplot2` defaults are not too bad, except for the desaturated plot.


```r
colorblindr::cvd_grid(p)
```

&lt;img src="index_files/figure-html/unnamed-chunk-34-1.svg" width="60%" style="display: block; margin: auto;" /&gt;

---

# Colours for colourblind readers

There are many palettes to choose from that are colorblind-friendly.

.pull-left[


```r
p &lt;- ggplot(
  penguins,
  aes(
    x = bill_length_mm,
    y = body_mass_g
  )
) +
  geom_point(aes(color = species)) +
* paletteer::scale_color_paletteer_d(
*   "khroma::contrast"
* )
```
]

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-36-1.svg" style="display: block; margin: auto;" /&gt;
]

---

# Colours for colourblind readers

This time, colors are more easily distinguishable.


```r
colorblindr::cvd_grid(p)
```

&lt;img src="index_files/figure-html/unnamed-chunk-37-1.svg" width="60%" style="display: block; margin: auto;" /&gt;

---

class: inverse, center, middle

# Titles

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/clem-onojeghuo-0PPKxWtYh0g-unsplash.jpg" alt="Old books placed vertically on a shelf." width = "550"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@clemono?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Clem Onojeghuo&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/library-title?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

---

# Titles

There are many ways to change the titles of the graphic and the axes. Here we are going to use the `labs()` function. 

These are the main parameters:

- `title`: Main title of the graph

- `x`, `y`: Titles for the axes

- `subtitle`: Subtitle title of the graph (default: under the main title)

- `caption`: Caption of the graph (default: bottom right of the graph)

---



count: false
 
# Axes and titles
.panel1-axes_and_titles1-auto[

```r
*ggplot(
* data = penguins,
* aes(
*   x = flipper_length_mm,
*   y = bill_length_mm,
*   color = species
* )
*) 
```
]
 
.panel2-axes_and_titles1-auto[
&lt;img src="index_files/figure-html/axes_and_titles1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Axes and titles
.panel1-axes_and_titles1-auto[

```r
ggplot(
  data = penguins,
  aes(
    x = flipper_length_mm,
    y = bill_length_mm,
    color = species
  )
) +
* geom_point()
```
]
 
.panel2-axes_and_titles1-auto[
&lt;img src="index_files/figure-html/axes_and_titles1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Axes and titles
.panel1-axes_and_titles1-auto[

```r
ggplot(
  data = penguins,
  aes(
    x = flipper_length_mm,
    y = bill_length_mm,
    color = species
  )
) +
  geom_point() +
* labs(
*   title = "Flipper and bill length",
*   subtitle = "Relationship between flipper and bill length",
*   caption = "Data from: palmerpenguins R package",
*   x = "Flipper length (mm)",
*   y = "Bill length (mm)",
*   color = "Penguin\nspecies"
* )
```
]
 
.panel2-axes_and_titles1-auto[
&lt;img src="index_files/figure-html/axes_and_titles1_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-axes_and_titles1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-axes_and_titles1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-axes_and_titles1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
# Controling axis labels
.panel1-axes_and_titles2-auto[

```r
*ggplot(
* data = penguins,
* aes(
*   x = flipper_length_mm,
*   y = bill_length_mm,
*   color = species
* )
*) 
```
]
 
.panel2-axes_and_titles2-auto[
&lt;img src="index_files/figure-html/axes_and_titles2_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Controling axis labels
.panel1-axes_and_titles2-auto[

```r
ggplot(
  data = penguins,
  aes(
    x = flipper_length_mm,
    y = bill_length_mm,
    color = species
  )
) +
* geom_point()
```
]
 
.panel2-axes_and_titles2-auto[
&lt;img src="index_files/figure-html/axes_and_titles2_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Controling axis labels
.panel1-axes_and_titles2-auto[

```r
ggplot(
  data = penguins,
  aes(
    x = flipper_length_mm,
    y = bill_length_mm,
    color = species
  )
) +
  geom_point() +
* scale_x_continuous(
*   breaks = c(180, 220),
*   labels = c("abc", "def")
* )
```
]
 
.panel2-axes_and_titles2-auto[
&lt;img src="index_files/figure-html/axes_and_titles2_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-axes_and_titles2-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-axes_and_titles2-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-axes_and_titles2-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

class: inverse, center, middle

# Faceting (small multiples)

---

# Faceting (small multiples)

Faceting is a technique that allows displaying additional categorical variables in facets. Within `ggplot2`, there are two types of faceting: `facet_grid()` and `facet_wrap()`.

&lt;img src="index_files/figure-html/unnamed-chunk-38-1.svg" style="display: block; margin: auto;" /&gt;

---



count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
*ggplot(
* data = drop_na(penguins, sex),
* aes(
*   x = body_mass_g,
*   y = bill_depth_mm,
*   color = sex
* )
*) 
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
* geom_point()
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
  geom_point() +
* facet_wrap(~species)
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
  geom_point() +
  facet_wrap(~species) +
* facet_wrap(~species, scales = "free_x")
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_04_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
  geom_point() +
  facet_wrap(~species) +
  facet_wrap(~species, scales = "free_x") +
* facet_wrap(~species, scales = "free_y")
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_05_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 1D faceting
.panel1-facet1-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
  geom_point() +
  facet_wrap(~species) +
  facet_wrap(~species, scales = "free_x") +
  facet_wrap(~species, scales = "free_y") +
* facet_wrap(~species, scales = "free")
```
]
 
.panel2-facet1-auto[
&lt;img src="index_files/figure-html/facet1_auto_06_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-facet1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-facet1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-facet1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
# 2D faceting
.panel1-facet3-auto[

```r
*ggplot(
* data = drop_na(penguins, sex),
* aes(
*   x = body_mass_g,
*   y = bill_depth_mm,
*   color = sex
* )
*) 
```
]
 
.panel2-facet3-auto[
&lt;img src="index_files/figure-html/facet3_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 2D faceting
.panel1-facet3-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
* geom_point()
```
]
 
.panel2-facet3-auto[
&lt;img src="index_files/figure-html/facet3_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# 2D faceting
.panel1-facet3-auto[

```r
ggplot(
  data = drop_na(penguins, sex),
  aes(
    x = body_mass_g,
    y = bill_depth_mm,
    color = sex
  )
) +
  geom_point() +
* facet_grid(island ~ species)
```
]
 
.panel2-facet3-auto[
&lt;img src="index_files/figure-html/facet3_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-facet3-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-facet3-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-facet3-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

class: inverse, center, middle

# Using ggplot2 themes

---

# ggplot2 themes

&gt; Themes are a powerful way to customize the non-data components of your plots: i.e. titles, labels, fonts, background, gridlines, and legends.

Many components can be changed using the `theme()` function. Today we are going to see just a few of them, but feel free to have a look at `?theme` to have more information.

--

`theme()` can be used to modify:

--

- The background aesthetics (colour, grid, etc.).

--

- Axis titles and ticks aesthetics.

--

- Legend titles and positions.

--

- Aesthetics of plot titles (title, subtitle, caption, etc.).

--

- Plot margins.

---






count: false
 
# Built in themes
.panel1-theme1-auto[

```r
*p 
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Built in themes
.panel1-theme1-auto[

```r
p +
* theme_bw()
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Built in themes
.panel1-theme1-auto[

```r
p +
  theme_bw() +
* theme_light()
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Built in themes
.panel1-theme1-auto[

```r
p +
  theme_bw() +
  theme_light() +
* theme_gray()
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_04_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Built in themes
.panel1-theme1-auto[

```r
p +
  theme_bw() +
  theme_light() +
  theme_gray() +
* theme_dark()
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_05_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Built in themes
.panel1-theme1-auto[

```r
p +
  theme_bw() +
  theme_light() +
  theme_gray() +
  theme_dark() +
* theme_void()
```
]
 
.panel2-theme1-auto[
&lt;img src="index_files/figure-html/theme1_auto_06_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-theme1-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-theme1-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-theme1-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# External themes

- You are not limited to using `ggplot2` built-in themes.

- Here are some themes provided by the `ggthemes` and `ggpubr` packages.


```r
install.packages("ggthemes")
install.packages("ggpubr")
```

---



count: false
 
# External themes
.panel1-theme2-auto[

```r
*p 
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
* ggthemes::theme_solarized()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
* ggthemes::theme_fivethirtyeight()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
  ggthemes::theme_fivethirtyeight() +
* ggthemes::theme_calc()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_04_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
  ggthemes::theme_fivethirtyeight() +
  ggthemes::theme_calc() +
* ggthemes::theme_excel()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_05_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
  ggthemes::theme_fivethirtyeight() +
  ggthemes::theme_calc() +
  ggthemes::theme_excel() +
* ggpubr::theme_pubr()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_06_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
  ggthemes::theme_fivethirtyeight() +
  ggthemes::theme_calc() +
  ggthemes::theme_excel() +
  ggpubr::theme_pubr() +
* ggpubr::theme_cleveland()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_07_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# External themes
.panel1-theme2-auto[

```r
p +
  ggthemes::theme_solarized() +
  ggthemes::theme_fivethirtyeight() +
  ggthemes::theme_calc() +
  ggthemes::theme_excel() +
  ggpubr::theme_pubr() +
  ggpubr::theme_cleveland() +
* ggpubr::theme_pubclean()
```
]
 
.panel2-theme2-auto[
&lt;img src="index_files/figure-html/theme2_auto_08_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-theme2-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-theme2-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-theme2-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
# Legend position
.panel1-legend_position-auto[

```r
*p 
```
]
 
.panel2-legend_position-auto[
&lt;img src="index_files/figure-html/legend_position_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Legend position
.panel1-legend_position-auto[

```r
p +
* theme(legend.position = "top")
```
]
 
.panel2-legend_position-auto[
&lt;img src="index_files/figure-html/legend_position_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Legend position
.panel1-legend_position-auto[

```r
p +
  theme(legend.position = "top") +
* theme(legend.position = "left")
```
]
 
.panel2-legend_position-auto[
&lt;img src="index_files/figure-html/legend_position_auto_03_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Legend position
.panel1-legend_position-auto[

```r
p +
  theme(legend.position = "top") +
  theme(legend.position = "left") +
* theme(legend.position = "bottom")
```
]
 
.panel2-legend_position-auto[
&lt;img src="index_files/figure-html/legend_position_auto_04_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-legend_position-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-legend_position-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-legend_position-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

# ggplot2 themes

- Many components can be modified with the `theme()` function. For example:

  - `axis.title`: Title appearance (font, color, ...)
  
  - `axis.ticks`: Axes ticks appearance (length, colour, position, ...)
  
  - `plot.background`: Background properties (color, ...)
  
  - `plot.margin`: Margins around the plot.
  
--

- Most of these components are modified using the `element_*()` functions.

  - `element_rect()`: for borders and backgrounds

  - `element_line()`: for lines elements

  - `element_text()`: for text

---



count: false
 
# Grid
.panel1-grid-auto[

```r
*p 
```
]
 
.panel2-grid-auto[
&lt;img src="index_files/figure-html/grid_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Grid
.panel1-grid-auto[

```r
p +
* theme(
*   panel.grid = element_line(
*     size = 3,
*     color = "red"
*   )
* )
```
]
 
.panel2-grid-auto[
&lt;img src="index_files/figure-html/grid_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-grid-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-grid-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-grid-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---



count: false
 
# Axes ticks
.panel1-ticks-auto[

```r
*p 
```
]
 
.panel2-ticks-auto[
&lt;img src="index_files/figure-html/ticks_auto_01_output-1.svg" style="display: block; margin: auto;" /&gt;
]

---
count: false
 
# Axes ticks
.panel1-ticks-auto[

```r
p +
* theme(
*   axis.ticks = element_line(
*     size = 2,
*     color = "blue"
*   ),
*   axis.ticks.length = unit(1, "cm")
* )
```
]
 
.panel2-ticks-auto[
&lt;img src="index_files/figure-html/ticks_auto_02_output-1.svg" style="display: block; margin: auto;" /&gt;
]

&lt;style&gt;
.panel1-ticks-auto {
  color: black;
  width: 38.6060606060606%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel2-ticks-auto {
  color: black;
  width: 59.3939393939394%;
  hight: 32%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
.panel3-ticks-auto {
  color: black;
  width: NA%;
  hight: 33%;
  float: left;
  padding-left: 1%;
  font-size: 80%
}
&lt;/style&gt;



---

class: inverse, center, middle

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://github.com/allisonhorst/stats-illustrations/blob/master/rstats-artwork/patchwork_1.jpg?raw=true" width="700"&gt;
&lt;figcaption&gt;
    Artwork by &lt;a href="https://twitter.com/allison_horst?s=20"&gt;@allison_horst&lt;/a&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;

---

# Combining plots

Many R packages can be used to combine plots.  Here we are going to have a quick overview of the `patchwork` package. The package is not part of base R so it needs to be installed and loaded before you can use it.

.pull-left[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://github.com/thomasp85/patchwork/blob/master/man/figures/logo.png?raw=true" width="200"&gt;
  &lt;figcaption&gt;
    &lt;a href="https://github.com/thomasp85/patchwork"&gt;The patchwork package&lt;/a&gt;
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

.pull-right[

```r
install.packages("patchwork")

library(patchwork)
```
]

---

# Plot #1

&lt;img src="index_files/figure-html/unnamed-chunk-41-1.svg" style="display: block; margin: auto;" /&gt;

---

# Plot #2

&lt;img src="index_files/figure-html/unnamed-chunk-42-1.svg" style="display: block; margin: auto;" /&gt;

---

# Combining horizontally

Combining horizontally is done using the `+` operator.


```r
p1 + p2
```

&lt;img src="index_files/figure-html/unnamed-chunk-43-1.svg" style="display: block; margin: auto;" /&gt;

---

# Combining vertically

Combining vertically is done using the `/` operator.


```r
p1 / p2
```

&lt;img src="index_files/figure-html/unnamed-chunk-44-1.svg" style="display: block; margin: auto;" /&gt;

---

# More complex arrangement


```r
(p1 + p2) / p1
```

&lt;img src="index_files/figure-html/unnamed-chunk-45-1.svg" width="100%" style="display: block; margin: auto;" /&gt;

---

# Adding labels

.pull-left[
It is often interesting to add a title and necessary to identify each panel (graph) with a letter. This can be achieved with the `plot_annotation()`.


```r
p1 / p2 +
  plot_annotation(
*   tag_levels = "A",
*   title = "The Palmer penguins"
  )
```
]

.pull-right[
&lt;img src="index_files/figure-html/plot-annotation2-1.svg" style="display: block; margin: auto;" /&gt;
]

---

class: inverse, center, middle

# Saving your graphics

&lt;br&gt;

.pull-left[<svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:200px;width:150px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#9EADBD;overflow:visible;position:relative;"><path d="M384 121.941V128H256V0h6.059a24 24 0 0 1 16.97 7.029l97.941 97.941a24.002 24.002 0 0 1 7.03 16.971zM248 160c-13.2 0-24-10.8-24-24V0H24C10.745 0 0 10.745 0 24v464c0 13.255 10.745 24 24 24h336c13.255 0 24-10.745 24-24V160H248zm-135.455 16c26.51 0 48 21.49 48 48s-21.49 48-48 48-48-21.49-48-48 21.491-48 48-48zm208 240h-256l.485-48.485L104.545 328c4.686-4.686 11.799-4.201 16.485.485L160.545 368 264.06 264.485c4.686-4.686 12.284-4.686 16.971 0L320.545 304v112z"/></svg>]
.pull-right[<svg aria-hidden="true" role="img" viewBox="0 0 384 512" style="height:200px;width:150px;vertical-align:-0.125em;margin-left:auto;margin-right:auto;font-size:inherit;fill:#C39AAC;overflow:visible;position:relative;"><path d="M181.9 256.1c-5-16-4.9-46.9-2-46.9 8.4 0 7.6 36.9 2 46.9zm-1.7 47.2c-7.7 20.2-17.3 43.3-28.4 62.7 18.3-7 39-17.2 62.9-21.9-12.7-9.6-24.9-23.4-34.5-40.8zM86.1 428.1c0 .8 13.2-5.4 34.9-40.2-6.7 6.3-29.1 24.5-34.9 40.2zM248 160h136v328c0 13.3-10.7 24-24 24H24c-13.3 0-24-10.7-24-24V24C0 10.7 10.7 0 24 0h200v136c0 13.2 10.8 24 24 24zm-8 171.8c-20-12.2-33.3-29-42.7-53.8 4.5-18.5 11.6-46.6 6.2-64.2-4.7-29.4-42.4-26.5-47.8-6.8-5 18.3-.4 44.1 8.1 77-11.6 27.6-28.7 64.6-40.8 85.8-.1 0-.1.1-.2.1-27.1 13.9-73.6 44.5-54.5 68 5.6 6.9 16 10 21.5 10 17.9 0 35.7-18 61.1-61.8 25.8-8.5 54.1-19.1 79-23.2 21.7 11.8 47.1 19.5 64 19.5 29.2 0 31.2-32 19.7-43.4-13.9-13.6-54.3-9.7-73.6-7.2zM377 105L279 7c-4.5-4.5-10.6-7-17-7h-6v128h128v-6.1c0-6.3-2.5-12.4-7-16.9zm-74.1 255.3c4.1-2.7-2.5-11.9-42.8-9 37.1 15.8 42.8 9 42.8 9z"/></svg>]


---

# Vector vs raster graphics

.pull-left[
&gt; The main difference between vector and raster graphics is that raster graphics are composed of pixels, while vector graphics are composed of paths.
.left[
&lt;credit&gt;
    Source: &lt;a href="https://www.geeksforgeeks.org/vector-vs-raster-graphics/"&gt;Vector vs Raster Graphics&lt;/a&gt;
&lt;/credit&gt;
]

- Scientific journals often require at least 300 DPI raster or vector graphics.

- **Attention: vector graphics can produce very large files for certain types of graphics (ex.: 3D plots).**

]

.pull-right[
&lt;center&gt;
&lt;figure&gt;
  &lt;img src="https://upload.wikimedia.org/wikipedia/commons/a/aa/VectorBitmapExample.svg" height="400"&gt;
  &lt;figcaption&gt;
    Source: Wikipedia 
&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;
]

---

# Saving your graphics

Saving `ggplot2` graphics is done with the `ggsave()` function.


```r
p &lt;- ggplot(mpg, aes(x = displ, y = cty)) +
  geom_point()
```

**Vector formats**


```r
ggsave("path/to/myfile.pdf", p, width = 5.97, height = 4.79)
ggsave("path/to/myfile.eps", p, width = 5.97, height = 4.79)
ggsave("path/to/myfile.ps", p, width = 5.97, height = 4.79)
```

**Raster formats**


```r
ggsave("path/to/myfile.jpg", p, width = 5.97, height = 4.79, dpi = 300)
ggsave("path/to/myfile.tiff", p, width = 5.97, height = 4.79, dpi = 300)
ggsave("path/to/myfile.png", p, width = 5.97, height = 4.79, dpi = 300)
```

---

class: inverse, center, middle

# Geospatial data

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/kyle-glenn-nXt5HtLmlgE-unsplash.jpg" alt="Earth globe palced on a table." width = "550"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@kylejglenn?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Kyle Glenn&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/geography?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

---

It is also possible to visualize geospatial data with `ggplot2`.

&lt;center&gt;
    &lt;img src="https://github.com/PMassicotte/makeovermonday/blob/master/graphs/makeovermonday_2019w50.png?raw=true" alt="drawing" width="700"/&gt;
&lt;/center&gt;

---

# Geospatial data

Making maps with `ggplot2` is out of the scope of this workshop. However, here is a quick overview with a simple example.

With **only a few lines of code**, we will make a map of the railways in Germany!

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/ankush-minda-7KKQG0eB_TI-unsplash.jpg" alt="Photo showing a train." width = "500"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@an_ku_sh?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Ankush Minda&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/train?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

---

# Geospatial data

There are many libraries that offer tools to work with spatial data in R:

- `sf`, `terra`, `raster`, `tmap`, `leaflet`, `stars`, `mapview`, ..., and of course `ggplot2`.

--

For this, I will use `sf` and `rnaturalearth` to manipulate and download spatial data.


```r
install.packages("sf")
install.packages("rnaturalearth")

library(sf)
library(rnaturalearth)
```

---

# Geospatial data

First, let's download the land data for Germany `rnaturalearth`.


```r
germany &lt;- ne_countries(country = "germany", returnclass = "sf", scale = "large")

germany
```

&lt;small&gt;

```
## Simple feature collection with 1 feature and 1 field
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 5.85249 ymin: 47.27112 xmax: 15.02206 ymax: 55.06533
## CRS:           +proj=longlat +datum=WGS84 +no_defs +ellps=WGS84 +towgs84=0,0,0
##    sovereignt                       geometry
## 50    Germany MULTIPOLYGON (((13.81572 48...
```
&lt;/small&gt;

---

# Geospatial data

The object `germany` is a `data.frame` containing a `geometry` column which co

&lt;small&gt;

```r
class(germany)
```

```
## [1] "sf"         "data.frame"
```
&lt;/small&gt;

--

.pull-left[
We can plot the geographic information contained in `germany` using the `st_geometry()` function from the `sf` package.
]

.pull-right[

```r
plot(st_geometry(germany))
```

&lt;img src="index_files/figure-html/unnamed-chunk-52-1.png" width="30%" style="display: block; margin: auto;" /&gt;
]

---

# Geospatial data

Secondly, let's download the railroad information.


```r
railroads &lt;- ne_download(
    category = "cultural",
    type = "railroads",
    returnclass = "sf",
    scale = "large",
  )
```

--

At this time, we have the railroad for the entire planet. Since we only need information for Germany, we will crop it using the `st_intersection()` function for the `sf` package.


```r
# Keep only the railroads that cross Germany
railroads &lt;- st_intersection(railroads, germany)
```

---

# Geospatial data

&lt;small&gt;

```
## Simple feature collection with 6 features and 4 fields
## Geometry type: GEOMETRY
## Dimension:     XY
## Bounding box:  xmin: 8.297778 ymin: 54.755 xmax: 9.453612 ymax: 54.90861
## Geodetic CRS:  WGS 84
##      rwdb_rr_id mult_track electric other_code                       geometry
## 4811       4812          0        0          1 LINESTRING (8.821666 54.791...
## 4812       4813          0        0          1 MULTILINESTRING ((8.297778 ...
## 4822       4823          0        0          1 LINESTRING (9.417223 54.766...
## 4830       4831          0        0          1 LINESTRING (9.451388 54.768...
## 4832       4833          0        0          1 LINESTRING (8.879167 54.758...
## 4840       4841          0        0          1 LINESTRING (9.383334 54.755...
```
&lt;/small&gt;

---

# Geospatial data

Spatial data can be plotted with `geom_sf()`:

&lt;small&gt;
.pull-left[

```r
ggplot() +
* geom_sf(
*   data = germany,
*   size = 0.25,
*   fill = "#F7F5FB"
* ) +
  geom_sf(
    data = railroads,
    size = 0.15,
    color = "#483A58"
  )
```
]
&lt;/small&gt;

.pull-right[
&lt;img src="index_files/figure-html/unnamed-chunk-54-1.png" width="70%" style="display: block; margin: auto;" /&gt;
]

---

class: inverse, center, middle

# Recommended ressources

---

&lt;!-- # ggplot2 cheat sheet --&gt;

&lt;center&gt;
&lt;figure&gt;
  &lt;img src="img/ggplot2_cheat_sheet_1.png" width="780"&gt;
  &lt;figcaption&gt;&lt;a href="https://raw.githubusercontent.com/rstudio/cheatsheets/main/data-visualization.pdf"&gt;Download the ggplot2 cheat sheet&lt;/a&gt;&lt;/figcaption&gt;
&lt;/figure&gt;
&lt;/center&gt;

---

# Free online books

.pull-left[
&lt;center&gt;
&lt;img src="img/r_graphics_cookbook.jpg" width="300"&gt;
&lt;figcaption&gt;&lt;a href="https://r-graphics.org/index.html"&gt;R Graphics Cookbook, 2nd edition&lt;/a&gt;&lt;/figcaption&gt;
&lt;/center&gt;
]

.pull-right[
&lt;center&gt;
&lt;img src="img/fundamentals_data_visualization_cover.png" width="300"&gt;
&lt;figcaption&gt;&lt;a href="https://clauswilke.com/dataviz/"&gt;Fundamentals of Data Visualization&lt;/a&gt;&lt;/figcaption&gt;
&lt;/center&gt;
]

---

# ggplot2 gallery

&lt;center&gt;
&lt;img src="img/ggplot2_extensions.png" width="1000"&gt;
&lt;figcaption&gt;&lt;a href="https://exts.ggplot2.tidyverse.org/gallery/"&gt;ggplot2 extensions - gallery&lt;/a&gt;
&lt;/figcaption&gt;
&lt;/center&gt;

---

class: inverse, center, middle

&lt;center&gt;
    &lt;figure&gt;
      &lt;img style="margin:0px auto;display:block" src="img/unsplash/kevin-butz-6hsfmat-t7k-unsplash.jpg" alt="Thank you painted on wood in front of a building." width = "800"/&gt;
    &lt;/figure&gt;
    &lt;figcaption&gt;Photo by &lt;a href="https://unsplash.com/@kevin_butz?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Kevin Butz&lt;/a&gt; on &lt;a href="https://unsplash.com/s/photos/thank-you?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText"&gt;Unsplash&lt;/a&gt;
    &lt;/figcaption&gt; 
&lt;/center&gt;

  
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"highlightSpans": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
